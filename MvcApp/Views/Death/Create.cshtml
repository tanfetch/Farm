
<div style="padding:30px">

<div id="ftitle" class="ftitle">死亡</div>  

    <div id="deathinfobar"></div>

<form action="/Death/Update" id="fm_newdeath" method="post">

    <div class="fitem">  
        <label>编号：</label>  
        <input id="newdeathkey" name="raiserID" value="@Request["key"]" class="easyui-validatebox" data-options="required:true">  
    </div> 
    <div class="fitem">  
        <label>死亡日期：</label>  
        <input name="deathDate" class="easyui-datebox" data-options="required:true">  
    </div> 
    <div class="fitem">  
        <label>死亡数量：</label>  
        <input name="deathNum" class="easyui-numberbox" data-options="required:true,min:1">  
    </div> 
        <div class="fitem">  
        <label></label>  
        <textarea name="description" placeholder = "填写备注信息"></textarea>  
    </div> 
    <div class="fitem" style="margin:30px 0;">  
    <label></label>  
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" plain="false" onclick="saveNewDeath()" >保存</a>

</form>
<script>
    function saveNewDeath() {
        var fm = $('#fm_newdeath');
        fm.ajaxSubmit({
            beforeSubmit: function () {
                return fm.form('validate');
            },
            success: function (data) {
                if (data.success) {
                    fm.form('reset');
                    showSuccess(data.message);
                }
                else {
                    showError(data.message);
                }
            }
        });
    }

    function showInfoForDeath() {
        $('#deathinfobar').html('');
        var key = $('#newdeathkey').val();
        if (key == "")
            return;
        $.ajax({
            url: '/Death/Update?view=piginfo&raiserID=' + key,
            success: function (data) {
                $('#deathinfobar').html(data);
            }
        });
    }

    $(document).ready(function () {
        showInfoForDeath();

        $('#newdeathkey').change(function () {
            showInfoForDeath();
        });


    })

</script>


</div>
